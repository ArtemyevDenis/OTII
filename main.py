import numpy as np

INPUT_DIM = 4
OUT_DIM = 3
H_DIM = 10
x=[]
x.append(float(input("Введите длину чашелистника: ")))
x.append(float(input("Введите ширина чашелистника: ")))
x.append(float(input("Введите длину лепестка: ")))
x.append(float(input("Введите ширина лепестка: ")))

W1 = np.array([[-0.34534156, 0.81522165, -0.3687942,  -0.29524495,  0.204857,   -0.29468755,
  -0.46184631, -0.35792008, -0.06146941,  0.18465798],
 [ 0.17864147,  0.55458779,  0.38850257,  0.44999959, -0.0842219,  -0.33494523,
   0.20923627,  0.19911058, -0.47068362,  0.40042741],
 [-0.47467583, -0.01327422,  0.27726832,  0.02411104,  0.40192359,  1.47129612,
   0.92264481, -0.04739803,  0.32389804,  0.30874807],
 [-0.04104997, -0.14790735, -0.33641012,  0.09995581, -0.06193657,  0.9762479,
   0.3844889,   0.16384828, -0.21533599, -0.38651662]])
b1 = np.array([[-0.31854374,  0.59777576, -0.36929777, -0.40600399,  0.45107053,  0.04890909,
  -0.09299129, -0.03187753, -0.04312819,  0.39415941]])
W2 = np.array(
 [[-0.06140047, -0.03153662, -0.18046366],
 [ 0.79883598,  0.19858715, -0.5882114],
 [ 0.17249891, -0.24423996, -0.05295438],
 [ 0.14917039, -0.12440241,  0.12956052],
 [-0.0136588,   0.36312411,  0.02828362],
 [-1.13286408,  0.07618904,  1.23255767],
 [-0.61137089, -0.18504551,  0.55715771],
 [ 0.03075116,  0.20113013,  0.13667644],
 [-0.18535497,  0.21341747, -0.26009426],
 [ 0.23772254,  0.33791228, -0.28003982]])
b2 = np.array([[ 0.45695715,  0.02781865, -0.15973351]])

def relu(t):
    return np.maximum(t, 0)

def softmax(t):
    out = np.exp(t)
    return out / np.sum(out)

def predict(x):
    t1 = x @ W1 + b1
    h1 = relu(t1)
    t2 = h1 @ W2 + b2
    z = softmax(t2)
    return z

probs = predict(x)
pred_class = np.argmax(probs)
class_names = ['Setosa', 'Versicolor', 'Virginica']
print('Predicted class:', class_names[pred_class])